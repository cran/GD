<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Yongze Song" />

<meta name="date" content="2020-05-28" />

<title>Optimal Parameters-based Geographical Detectors</title>

<script src="GD_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="GD_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="GD_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="GD_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="GD_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="GD_files/navigation-1.1/tabsets.js"></script>
<link href="GD_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="GD_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Optimal Parameters-based Geographical Detectors</h1>
<h4 class="author">Yongze Song</h4>
<h4 class="date">2020-05-28</h4>

</div>


<p> </p>
<div id="latest-version" class="section level4">
<h4>Latest version</h4>
<p><a href="https://cran.r-project.org/package=GD"><img src="https://www.r-pkg.org/badges/version/GD?color=orange" /></a> <a href="https://cran.r-project.org/package=GD"><img src="http://cranlogs.r-pkg.org/badges/grand-total/GD?color=blue" /></a> <a href="https://cran.r-project.org/package=GD"><img src="http://cranlogs.r-pkg.org/badges/last-month/GD?color=yellow" /></a> <a href="https://doi.org/10.1080/15481603.2020.1760434"><img src="https://img.shields.io/badge/Publication%20doi-10.1080/15481603.2020.1760434-green.svg" /></a></p>
<p> </p>
</div>
<div id="citation-for-package-gd" class="section level3">
<h3>Citation for package <code>GD</code></h3>
<p>To cite <strong>“GD” R package</strong> in publications, please use:</p>
<p><strong>Song, Y., Wang, J., Ge, Y. &amp; Xu, C. (2020) “An optimal parameters-based geographical detector model enhances geographic characteristics of explanatory variables for spatial heterogeneity analysis: Cases with different types of spatial data”, <em>GIScience &amp; Remote Sensing</em>.</strong> <a href="https://doi.org/10.1080/15481603.2020.1760434"><img src="https://img.shields.io/badge/doi-10.1080/15481603.2020.1760434-yellow.svg" /></a></p>
<p> </p>
<p> </p>
</div>
<div id="authors-affiliations" class="section level3">
<h3>Authors’ affiliations</h3>
<div id="dr.yongze-song" class="section level4">
<h4>Dr. Yongze Song</h4>
<p><a href="https://scholar.google.com.au/citations?user=bNuxvgIAAAAJ&amp;hl=en&amp;oi=ao">Google Scholar</a></p>
<p>Research interests: Spatial statistics, sustainable infrastructure</p>
<p>Curtin University, Australia</p>
<p>Email <a href="mailto:yongze.song@curtin.edu.au">yongze.song@curtin.edu.au</a></p>
<p><strong>Award:</strong></p>
<p><strong>Global Peer Review Awards 2019: Top reviewers in Geosciences (top 1%) and in Cross-field (top 1%). </strong></p>
<p><strong>R Packages:</strong></p>
<p><code>GD</code> <a href="https://cran.r-project.org/package=GD"><img src="http://cranlogs.r-pkg.org/badges/grand-total/GD?color=orange" /></a> <code>SK</code> <a href="https://cran.r-project.org/package=SK"><img src="http://cranlogs.r-pkg.org/badges/grand-total/SK?color=blue" /></a> <code>EDA</code> <a href="https://cran.r-project.org/package=EDA"><img src="http://cranlogs.r-pkg.org/badges/grand-total/EDA?color=yellow" /></a> <code>HS</code> <a href="https://cran.r-project.org/package=HS"><img src="http://cranlogs.r-pkg.org/badges/grand-total/HS?color=green" /></a></p>
<p> </p>
<p> </p>
</div>
</div>
<div id="introduction-to-gd-package" class="section level2">
<h2>Introduction to <code>GD</code> package</h2>
<p>Spatial stratified heterogeneity can be measured using geographical detectors (<a href="https://www.tandfonline.com/doi/abs/10.1080/13658810802443457">Wang et al. 2010</a>, <a href="https://www.sciencedirect.com/science/article/pii/S1470160X16300735?via%3Dihub">Wang et al. 2016</a>).</p>
<p>Power of determinants is computed using a <span class="math inline">\(Q\)</span>-statistic:</p>
<p><span class="math display">\[Q=1-\displaystyle \frac{\sum_{j=1}^{M} N_{j} \sigma_{j}^2}{N \sigma^2} \]</span></p>
<p>where <span class="math inline">\(N\)</span> and <span class="math inline">\(\sigma^2\)</span> are the number and population variance of observations within the whole study area, and <span class="math inline">\(N_{j}\)</span> and <span class="math inline">\(\sigma_{j}^2\)</span> are the number and population variance of observations within the <span class="math inline">\(j\)</span>th (<span class="math inline">\(j\)</span>=1,…,<span class="math inline">\(M\)</span>) sub-region of an explantory variable.</p>
<p><strong>Please note that in <code>R</code> environment, <code>sd</code> and <code>var</code> functions are used for computing sample standard deviation and sample variance.</strong> If sample variance is used in the computation, the equation of <span class="math inline">\(Q\)</span>-statistic can be converted to:</p>
<p><span class="math display">\[Q=1-\displaystyle \frac{\sum_{j=1}^{M} (N_{j}-1) s_{j}^2}{(N-1) s^2} \]</span></p>
<p>where <span class="math inline">\(s^2\)</span> and <span class="math inline">\(s_{j}^2\)</span> are sample variance of observations in the whole study area and in the <span class="math inline">\(j\)</span>th sub-region.</p>
<div class="figure">
<img src="Figure1.png" alt="Figure 1. Overview of global research using geographical detector model (cumulative citations were updated on June 2020). (Song et al. 2020)" width="450" />
<p class="caption"><strong>Figure 1</strong>. Overview of global research using geographical detector model (<em>cumulative citations were updated on June 2020</em>). (<a href="https://doi.org/10.1080/15481603.2020.1760434">Song et al. 2020</a>)</p>
</div>
<div id="the-model-can-be-used-to-address-following-issues" class="section level3">
<h3>The model can be used to address following issues:</h3>
<ul>
<li><p>Explore potential factors or explanatory variables from a spatial perspective.</p></li>
<li><p>Explore potential interactive impacts of geogrpahical variables.</p></li>
<li><p>Identify high-risk or low-risk regions from potential explanatory variables.</p></li>
</ul>
</div>
<div id="the-gd-package-makes-following-steps-fast-and-easy" class="section level3">
<h3>The <strong><code>GD</code> package</strong> makes following steps fast and easy:</h3>
<ul>
<li><p>It contains both supervised and unsupervised spatial data discretization methods, and the optimal spatial discretization method for continuous variables;</p></li>
<li><p>It contains four primary functions of geographical detectors, including factor detector, risk detector, interaction detector and ecological detector;</p></li>
<li><p>It can be used to compare size effects of spatial unit;</p></li>
<li><p>It provides diverse visualizations of spatial analysis results;</p></li>
<li><p>It contains detailed significance tests for spatial analysis in each step of geographical detectors.</p></li>
</ul>
<div class="figure">
<img src="Figure2.png" alt="Figure 2. General calculation process and relationships of functions in GD package (Song et al. 2020)" width="600" />
<p class="caption"><strong>Figure 2</strong>. General calculation process and relationships of functions in GD package (<a href="https://doi.org/10.1080/15481603.2020.1760434">Song et al. 2020</a>)</p>
</div>
<p>Further information can be found on the <a href="https://CRAN.R-project.org/package=GD">manual</a> of <strong>GD</strong> package.</p>
<p>More applications of geographical detectors are listed on <a href="http://www.geodetector.cn">Geodetector website</a>.</p>
<p>   </p>
</div>
</div>
<div id="discretization-and-optimal-discretization" class="section level2">
<h2>Discretization and optimal discretization</h2>
<p>Categorical variables are required for geographical detectors, so continuous variables should be discretized before modelling. <strong>GD</strong> package provides two options: discretization with given parameters, including discretization methods and numbers of intervals, and optimal discretization with a series of optional parameter combinations. Dataset <code>ndvi_40</code> is used as an example for explanation.</p>
<pre class="r"><code>install.packages(&quot;GD&quot;)</code></pre>
<pre class="r"><code>library(&quot;GD&quot;)
#&gt; This is GD 1.8.
#&gt;                         
#&gt; To cite GD in publications, please use:
#&gt;                         
#&gt; Song, Y., Wang, J., Ge, Y. &amp; Xu, C. (2020) An optimal parameters-based geographical detector model enhances geographic characteristics of explanatory variables for spatial heterogeneity analysis: Cases with different types of spatial data, GIScience &amp; Remote Sensing, doi: 10.1080/15481603.2020.1760434.
#&gt; 
data(&quot;ndvi_40&quot;)
head(ndvi_40)[1:3,]
#&gt;   NDVIchange Climatezone Mining Tempchange Precipitation   GDP Popdensity
#&gt; 1    0.11599         Bwk    low    0.25598        236.54 12.55    1.44957
#&gt; 2    0.01783         Bwk    low    0.27341        213.55  2.69    0.80124
#&gt; 3    0.13817         Bsk    low    0.30247        448.88 20.06   11.49432</code></pre>
<div id="discretization-with-given-parameters-disc" class="section level3">
<h3>Discretization with given parameters: <code>disc</code></h3>
<pre class="r"><code>## discretization methods: equal, natural, quantile (default), geometric, sd and manual
ds1 &lt;- disc(ndvi_40$Tempchange, 4)
ds1
plot(ds1)</code></pre>
<p>Further information can be found on the <a href="https://CRAN.R-project.org/package=GD">manual</a> of <strong>GD</strong> package.</p>
</div>
<div id="optimal-discretization-optidisc" class="section level3">
<h3>Optimal discretization: <code>optidisc</code></h3>
<pre class="r"><code>## set optional discretization methods and numbers of intervals
discmethod &lt;- c(&quot;equal&quot;,&quot;natural&quot;,&quot;quantile&quot;,&quot;geometric&quot;,&quot;sd&quot;)
discitv &lt;- c(4:7)
## optimal discretization
odc1 &lt;- optidisc(NDVIchange ~ Tempchange, data = ndvi_40,
                 discmethod, discitv)
odc1
plot(odc1)</code></pre>
<div class="figure">
<img src="Figure3.png" alt="Figure 3. Process and results of optimal spatial data discretization" width="600" />
<p class="caption"><strong>Figure 3</strong>. Process and results of optimal spatial data discretization</p>
</div>
</div>
</div>
<div id="optimal-parameters-based-geographical-detectors" class="section level2">
<h2>(Optimal Parameters-based) Geographical Detectors</h2>
<p><strong>GD</strong> package provides two options for geographical detectors modelling:</p>
<ul>
<li><p>four functions are performed step by step: <code>gd</code> for factor detector, <code>riskmean</code> and <code>gdrisk</code> for risk detector, <code>gdinteract</code> for interaction detector and <code>gdeco</code> for ecological detector;</p></li>
<li><p>optimal discretization and geographical detectors are performed using a one-step function <code>gdm</code>.</p></li>
</ul>
<div id="a-one-step-function-gdm-highly-recommended" class="section level3">
<h3>A one-step function: <code>gdm</code> (<em>Highly Recommended</em>)</h3>
<pre class="r"><code>## NDVI: ndvi_40
## set optional parameters of optimal discretization
## optional methods: equal, natural, quantile, geometric, sd and manual
discmethod &lt;- c(&quot;equal&quot;,&quot;natural&quot;,&quot;quantile&quot;)
discitv &lt;- c(4:6)
## &quot;gdm&quot; function
ndvigdm &lt;- gdm(NDVIchange ~ Climatezone + Mining + Tempchange + GDP,
               continuous_variable = c(&quot;Tempchange&quot;, &quot;GDP&quot;),
               data = ndvi_20,
               discmethod = discmethod, discitv = discitv)
ndvigdm
plot(ndvigdm)

## H1N1: h1n1_100
## set optional parameters of optimal discretization
discmethod &lt;- c(&quot;equal&quot;,&quot;natural&quot;,&quot;quantile&quot;,&quot;geometric&quot;,&quot;sd&quot;)
discitv &lt;- c(3:7)
continuous_variable &lt;- colnames(h1n1_100)[-c(1,11)]
## &quot;gdm&quot; function
h1n1gdm &lt;- gdm(H1N1 ~ .,
               continuous_variable = continuous_variable,
               data = h1n1_100,
               discmethod = discmethod, discitv = discitv)
h1n1gdm
plot(h1n1gdm)</code></pre>
</div>
<div id="factor-detector-gd" class="section level3">
<h3>Factor detector: <code>gd</code></h3>
<pre class="r"><code>## a categorical explanatory variable
g1 &lt;- gd(NDVIchange ~ Climatezone, data = ndvi_40)
g1

## multiple categorical explanatory variables
g2 &lt;- gd(NDVIchange ~ ., data = ndvi_40[,1:3])
g2
plot(g2)

## multiple variables inclusing continuous variables
discmethod &lt;- c(&quot;equal&quot;,&quot;natural&quot;,&quot;quantile&quot;,&quot;geometric&quot;,&quot;sd&quot;)
discitv &lt;- c(3:7)
data.ndvi &lt;- ndvi_40

data.continuous &lt;- data.ndvi[, c(1, 4:7)]
odc1 &lt;- optidisc(NDVIchange ~ ., data = data.continuous, discmethod, discitv)
data.continuous &lt;- do.call(cbind, lapply(1:4, function(x)
  data.frame(cut(data.continuous[, -1][, x], unique(odc1[[x]]$itv), include.lowest = TRUE))))
    # add stratified data to explanatory variables
data.ndvi[, 4:7] &lt;- data.continuous

g3 &lt;- gd(NDVIchange ~ ., data = data.ndvi)
g3
plot(g3)</code></pre>
<div class="figure">
<img src="Figure4.png" alt="Figure 4. Results of factor detector" width="300" />
<p class="caption"><strong>Figure 4</strong>. Results of factor detector</p>
</div>
</div>
<div id="risk-detector-riskmean-and-gdrisk" class="section level3">
<h3>Risk detector: <code>riskmean</code> and <code>gdrisk</code></h3>
<p>Risk mean values by variables:</p>
<pre class="r"><code>## categorical explanatory variables
rm1 &lt;- riskmean(NDVIchange ~ Climatezone + Mining, data = ndvi_40)
rm1
plot(rm1)
## multiple variables inclusing continuous variables
rm2 &lt;- riskmean(NDVIchange ~ ., data = data.ndvi)
rm2
plot(rm2)</code></pre>
<p>Risk matrix:</p>
<pre class="r"><code>## categorical explanatory variables
gr1 &lt;- gdrisk(NDVIchange ~ Climatezone + Mining, data = ndvi_40)
gr1
plot(gr1)
## multiple variables inclusing continuous variables
gr2 &lt;- gdrisk(NDVIchange ~ ., data = data.ndvi)
gr2
plot(gr2)</code></pre>
<div class="figure">
<img src="Figure5.png" alt="Figure 5. Results of risk detector" width="500" />
<p class="caption"><strong>Figure 5</strong>. Results of risk detector</p>
</div>
</div>
<div id="interaction-detector-gdinteract" class="section level3">
<h3>Interaction detector: <code>gdinteract</code></h3>
<pre class="r"><code>## categorical explanatory variables
gi1 &lt;- gdinteract(NDVIchange ~ Climatezone + Mining, data = ndvi_40)
gi1
## multiple variables inclusing continuous variables
gi2 &lt;- gdinteract(NDVIchange ~ ., data = data.ndvi)
gi2
plot(gi2)</code></pre>
<div class="figure">
<img src="Figure6.png" alt="Figure 6. Results of interaction detector" width="400" />
<p class="caption"><strong>Figure 6</strong>. Results of interaction detector</p>
</div>
</div>
<div id="ecological-detector-gdeco" class="section level3">
<h3>Ecological detector: <code>gdeco</code></h3>
<pre class="r"><code>## categorical explanatory variables
ge1 &lt;- gdeco(NDVIchange ~ Climatezone + Mining, data = ndvi_40)
ge1
## multiple variables inclusing continuous variables
gd3 &lt;- gdeco(NDVIchange ~ ., data = data.ndvi)
gd3
plot(gd3)</code></pre>
<div class="figure">
<img src="Figure7.png" alt="Figure 7. Results of ecological detector" width="300" />
<p class="caption"><strong>Figure 7</strong>. Results of ecological detector</p>
</div>
</div>
</div>
<div id="comparison-of-size-effects-of-spatial-unit" class="section level2">
<h2>Comparison of size effects of spatial unit</h2>
<pre class="r"><code>ndvilist &lt;- list(ndvi_20, ndvi_30, ndvi_40, ndvi_50)
su &lt;- c(20,30,40,50) ## sizes of spatial units
## &quot;gdm&quot; function
gdlist &lt;- lapply(ndvilist, function(x){
  gdm(NDVIchange ~ Climatezone + Mining + Tempchange + GDP,
      continuous_variable = c(&quot;Tempchange&quot;, &quot;GDP&quot;),
      data = x, discmethod = &quot;quantile&quot;, discitv = 6)
})
sesu(gdlist, su) ## size effects of spatial units</code></pre>
<div class="figure">
<img src="Figure8.png" alt="Figure 8. Spatial scale effects" width="350" />
<p class="caption"><strong>Figure 8</strong>. Spatial scale effects</p>
</div>
<p> </p>
</div>
<div id="reference" class="section level2">
<h2>Reference</h2>
<p>Song Y, Wang J, Ge Y and Xu C (2020) “An optimal parameters-based geographical detector model enhances geographic characteristics of explanatory variables for spatial heterogeneity analysis: Cases with different types of spatial data.” GIScience &amp; Remote Sensing, doi: <a href="https://doi.org/10.1080/15481603.2020.1760434">10.1080/15481603.2020.1760434</a>.</p>
<p>Wang J, Zhang T and Fu B (2016). “A measure of spatial stratified heterogeneity.” Ecological Indicators, 67, pp. 250-256. doi: <a href="https://www.sciencedirect.com/science/article/pii/S1470160X16300735?via%3Dihub">10.1016/j.ecolind.2016.02.052</a>.</p>
<p>Wang J, Li X, Christakos G, Liao Y, Zhang T, Gu X and Zheng X (2010). “Geographical Detectors-Based Health Risk Assessment and its Application in the Neural Tube Defects Study of the Heshun Region, China.” International Journal of Geographical Information Science, 24(1), pp. 107-127. doi: <a href="https://www.tandfonline.com/doi/abs/10.1080/13658810802443457">10.1080/13658810802443457</a>.</p>
<p>Song Y, Wright G, Wu P, Thatcher D, McHugh T, Li Q, Li SJ and Wang X (2018). “Segment-Based Spatial Analysis for Assessing Road Infrastructure Performance Using Monitoring Observations and Remote Sensing Data”. Remote Sensing, 10(11), pp. 1696. doi: <a href="https://doi.org/10.3390/rs10111696">10.3390/rs10111696</a>.</p>
<p>Song Y, Wang X, Wright G, Thatcher D, Wu P and Felix P (2019). “Traffic Volume Prediction With Segment-Based Regression Kriging and its Implementation in Assessing the Impact of Heavy Vehicles.” IEEE Transactions on Intelligent Transportation Systems, 20(1), pp. 232 - 243. doi: <a href="https://ieeexplore.ieee.org/document/8307463/">10.1109/TITS.2018.2805817</a>.</p>
<p>Xu C and Wang J (2018). Geodetector Website. <a href="http://www.geodetector.cn" class="uri">http://www.geodetector.cn</a>.</p>
<p> </p>
<p>   </p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
